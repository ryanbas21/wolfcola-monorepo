{"version":3,"file":"keyValueStore.js","names":["Schema","_interopRequireWildcard","require","Context","Effect","_Function","Layer","Option","PlatformError","FileSystem","Path","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","TypeId","exports","Symbol","for","keyValueStoreTag","GenericTag","make","impl","of","key","map","isSome","isEmpty","size","modify","f","flatMap","o","isNone","succeedNone","newValue","value","as","some","forSchema","schema","makeSchemaStore","prefix","dual","self","remove","SchemaStoreTypeId","store","jsonSchema","parseJson","parse","decodeUnknown","encode","match","onNone","onSome","asSome","json","clear","layerMemory","sync","Map","fromNullable","delete","layerFileSystem","directory","effect","gen","_","fs","path","keyPath","join","encodeURIComponent","exists","makeDirectory","recursive","pipe","readFileString","catchTag","sysError","reason","succeed","none","fail","writeFileString","zipRight","readDirectory","files","length","layerSchema","tagIdentifier","tag","layer","storageError","props","SystemError","module","layerStorage","evaluate","storage","try","getItem","catch","pathOrDescriptor","method","message","setItem","removeItem"],"sources":["../../../src/internal/keyValueStore.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}