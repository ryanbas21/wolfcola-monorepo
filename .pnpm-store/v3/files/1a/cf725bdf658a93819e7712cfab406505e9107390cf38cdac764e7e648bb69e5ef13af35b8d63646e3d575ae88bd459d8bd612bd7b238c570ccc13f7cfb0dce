{"version":3,"file":"keyValueStore.js","names":["Schema","Context","Effect","dual","pipe","Layer","Option","PlatformError","FileSystem","Path","TypeId","Symbol","for","keyValueStoreTag","GenericTag","make","impl","of","has","key","map","get","isSome","isEmpty","size","modify","f","flatMap","o","isNone","succeedNone","newValue","value","as","set","some","forSchema","schema","makeSchemaStore","prefix","self","remove","SchemaStoreTypeId","store","jsonSchema","parseJson","parse","decodeUnknown","encode","match","onNone","onSome","asSome","json","clear","layerMemory","sync","Map","fromNullable","delete","layerFileSystem","directory","effect","gen","_","fs","path","keyPath","join","encodeURIComponent","exists","makeDirectory","recursive","readFileString","catchTag","sysError","reason","succeed","none","fail","writeFileString","zipRight","readDirectory","files","length","layerSchema","tagIdentifier","tag","layer","storageError","props","SystemError","module","layerStorage","evaluate","storage","try","getItem","catch","pathOrDescriptor","method","message","setItem","removeItem"],"sources":["../../../src/internal/keyValueStore.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}