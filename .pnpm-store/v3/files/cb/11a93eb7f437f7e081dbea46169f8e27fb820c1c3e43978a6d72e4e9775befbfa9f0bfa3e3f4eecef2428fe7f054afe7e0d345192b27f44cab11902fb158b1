{"version":3,"file":"workerRunner.js","names":["_WorkerError","require","Runner","_interopRequireWildcard","Deferred","Effect","ExecStrategy","Exit","FiberId","FiberSet","_GlobalValue","Layer","Scope","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","cachedPorts","globalValue","Set","globalHandleConnect","event","add","ports","self","onconnect","make","PlatformRunner","of","PlatformRunnerTypeId","start","sync","currentPortId","Map","send","portId","message","transfer","postMessage","run","handler","uninterruptibleMask","restore","pipe","bindTo","bind","scope","extend","fiberSet","runtime","tap","runFork","onMessage","data","port","close","void","delete","size","unsafeDone","deferred","interrupt","none","onMessageError","error","WorkerError","reason","cause","onError","handlePort","fork","sequential","flatMap","onMsg","addEventListener","addFinalizer","removeEventListener","prevOnConnect","clear","join","ensuring","exports","layerMessagePort","succeed","layer"],"sources":["../../../src/internal/workerRunner.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}