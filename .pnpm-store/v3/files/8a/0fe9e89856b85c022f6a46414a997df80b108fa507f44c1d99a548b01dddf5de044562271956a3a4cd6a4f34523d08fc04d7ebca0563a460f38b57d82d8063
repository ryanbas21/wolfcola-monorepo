{"version":3,"file":"workerRunner.js","names":["WorkerError","Runner","Deferred","Effect","ExecStrategy","Exit","FiberId","FiberSet","globalValue","Layer","Scope","cachedPorts","Set","globalHandleConnect","event","add","ports","self","onconnect","make","PlatformRunner","of","PlatformRunnerTypeId","start","sync","currentPortId","Map","send","portId","message","transfer","get","postMessage","run","handler","uninterruptibleMask","restore","pipe","bindTo","bind","scope","extend","fiberSet","runtime","tap","runFork","onMessage","data","port","close","void","delete","size","unsafeDone","deferred","interrupt","none","onMessageError","error","reason","cause","onError","handlePort","fork","sequential","flatMap","set","onMsg","addEventListener","addFinalizer","removeEventListener","prevOnConnect","clear","join","ensuring","layerMessagePort","succeed","layer"],"sources":["../../../src/internal/workerRunner.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}